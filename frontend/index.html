<!doctype html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <!-- Enhanced viewport for better mobile experience -->
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover" />

  <!-- SEO and Mobile Meta Tags -->
  <title>Ù…ØªØ¬Ø± Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ - Alnafar Store | Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ù„Ø£Ø¬Ù‡Ø²Ø© PS Ùˆ PC</title>
  <meta name="description"
    content="Ù…Ù†Ø¸ÙˆÙ…Ø©  Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ - Ø§Ø®ØªØ± Ù„Ø¹Ø¨Ø© Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø± Ù„Ø£Ø¬Ù‡Ø²Ø© PlayStation Ùˆ PC. Ø£Ø³Ø¹Ø§Ø± Ù…Ù†Ø§ÙØ³Ø© ÙÙŠ Ù„ÙŠØ¨ÙŠØ§." />
  <meta name="keywords" content="Ø£Ù„Ø¹Ø§Ø¨, ØªØ£Ø¬ÙŠØ± Ø£Ù„Ø¹Ø§Ø¨, PlayStation, PC, Ù„ÙŠØ¨ÙŠØ§, Ù…ØªØ¬Ø± Ø£Ù„Ø¹Ø§Ø¨, PS4, PS5" />

  <!-- Mobile Web App Meta Tags -->
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Alnafar Store" />
  <meta name="theme-color" content="#14b8a6" />
  <meta name="msapplication-TileColor" content="#14b8a6" />

  <!-- Prevent automatic phone number detection -->
  <meta name="format-detection" content="telephone=no" />

  <!-- Favicon / App Icons -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="icon" type="image/png" href="/icon-192x192.png" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="192x192" href="/icon-192x192.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="/icon-512x512.png" />

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json" />

  <!-- Google Fonts - Arabic & English -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Cairo: Modern Arabic font with excellent readability -->
  <!-- Inter: Clean English font that pairs well with Cairo -->
  <link
    href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&family=Inter:wght@300;400;600;700;900&display=swap"
    rel="stylesheet">

  <!-- Preload critical resources -->
  <!-- <link rel="preload" href="/src/styles.css" as="style" /> -->


  <!-- Performance optimization -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com" />
  <link rel="dns-prefetch" href="//fonts.gstatic.com" />
  <link rel="dns-prefetch" href="//cdnjs.cloudflare.com" />
</head>

<body>
  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>

  <!-- PWA Service Worker Registration -->
  <script>
    // Register Service Worker for PWA functionality
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        // Ù„Ø§ ØªØ³Ø¬Ù„ sw.js ÙÙŠ ØµÙØ­Ø© Ø§Ù„ØªØªØ¨Ø¹ (Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¹Ø§Ø±Ø¶ Ù…Ø¹ service-worker.js Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª)
        if (window.location.hash && window.location.hash.startsWith('#/track/')) return;

        navigator.serviceWorker.register('/sw.js')
          .then((registration) => {
            console.log('SW registered: ', registration);
            // Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª ØªØªÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¯ÙˆÙ† Ø¥Ø²Ø¹Ø§Ø¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
          })
          .catch((registrationError) => {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }

    // PWA Install Prompt â€” Ù„Ø§ ØªØ¸Ù‡Ø± ÙÙŠ ØµÙØ­Ø© Ø§Ù„ØªØªØ¨Ø¹
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      // Ù„Ø§ ØªØ¸Ù‡Ø± ÙÙŠ ØµÙØ­Ø© Ø§Ù„ØªØªØ¨Ø¹
      if (window.location.hash && window.location.hash.startsWith('#/track/')) return;
      showInstallPromotion();
    });

    function showInstallPromotion() {
      if (document.getElementById('install-button')) return;
      const installButton = document.createElement('button');
      installButton.id = 'install-button';
      installButton.innerHTML = 'ğŸ“± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚';
      installButton.style.cssText = `
          position: fixed;
          bottom: 20px;
          right: 20px;
          background: #14b8a6;
          color: white;
          border: none;
          padding: 12px 20px;
          border-radius: 25px;
          font-family: Cairo, sans-serif;
          font-weight: 600;
          cursor: pointer;
          box-shadow: 0 4px 12px rgba(20, 184, 166, 0.3);
          z-index: 1000;
          transition: all 0.3s ease;
        `;

      installButton.addEventListener('click', async () => {
        if (deferredPrompt) {
          deferredPrompt.prompt();
          const { outcome } = await deferredPrompt.userChoice;
          console.log(`User response to the install prompt: ${outcome}`);
          deferredPrompt = null;
          installButton.remove();
        }
      });

      document.body.appendChild(installButton);

      // Auto-hide after 10 seconds
      setTimeout(() => {
        if (installButton && installButton.parentNode) {
          installButton.style.opacity = '0';
          setTimeout(() => installButton.remove(), 300);
        }
      }, 10000);
    }

    // Handle app installation
    window.addEventListener('appinstalled', (evt) => {
      console.log('App was installed');
      // Hide install button if it exists
      const installButton = document.getElementById('install-button');
      if (installButton) {
        installButton.remove();
      }

      // Show success message
      const successMsg = document.createElement('div');
      successMsg.innerHTML = 'âœ… ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­!';
      successMsg.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: #10b981;
          color: white;
          padding: 12px 20px;
          border-radius: 8px;
          font-family: Cairo, sans-serif;
          z-index: 1001;
          box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        `;
      document.body.appendChild(successMsg);
      setTimeout(() => successMsg.remove(), 3000);
    });

    // Simple print function - opens browser print dialog like printatestpage.com
    window.enhancedPrint = function () {
      console.log('ğŸ–¨ï¸ Opening browser print dialog');
      window.print();
    };

    // Sunmi innerPrinter detection and setup
    window.addEventListener('load', function () {
      // Check for Sunmi innerPrinter availability
      if (typeof Android !== 'undefined' && Android.innerPrinter) {
        window.sunmiInnerPrinter = Android.innerPrinter;
        console.log('âœ… Sunmi innerPrinter detected via Android interface');
      } else if (window.sunmiInnerPrinter) {
        console.log('âœ… Sunmi innerPrinter already available');
      } else {
        console.log('â„¹ï¸ Sunmi innerPrinter not detected, using web printing');
      }
    });
  </script>
</body>

</html>